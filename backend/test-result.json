{"numTotalTestSuites":9,"numPassedTestSuites":3,"numFailedTestSuites":6,"numPendingTestSuites":0,"numTotalTests":14,"numPassedTests":8,"numFailedTests":6,"numPendingTests":0,"numTodoTests":0,"snapshot":{"added":0,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0,"didUpdate":false},"startTime":1772053093302,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["POST /api/auth/session"],"fullName":"POST /api/auth/session should create a new session and set cookie","status":"failed","title":"should create a new session and set cookie","duration":363.30960000000005,"failureMessages":["AssertionError: expected 201 to be 200 // Object.is equality\n    at C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/auth.test.ts:16:28\n    at processTicksAndRejections (node:internal/process/task_queues:103:5)\n    at file:///C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/node_modules/@vitest/runner/dist/index.js:915:20"],"meta":{}},{"ancestorTitles":["POST /api/auth/logout"],"fullName":"POST /api/auth/logout should destroy session and clear cookie","status":"passed","title":"should destroy session and clear cookie","duration":366.0877999999998,"failureMessages":[],"meta":{}},{"ancestorTitles":["POST /api/auth/logout"],"fullName":"POST /api/auth/logout should return success even without session cookie","status":"passed","title":"should return success even without session cookie","duration":3.220100000000002,"failureMessages":[],"meta":{}},{"ancestorTitles":["POST /api/auth/logout"],"fullName":"POST /api/auth/logout should reject replayed cookie after logout","status":"passed","title":"should reject replayed cookie after logout","duration":660.8457000000001,"failureMessages":[],"meta":{}},{"ancestorTitles":["GET /api/health"],"fullName":"GET /api/health should return health status","status":"passed","title":"should return health status","duration":3.11429999999973,"failureMessages":[],"meta":{}},{"ancestorTitles":["404 handling"],"fullName":"404 handling should return 404 for unknown routes","status":"passed","title":"should return 404 for unknown routes","duration":2.371399999999994,"failureMessages":[],"meta":{}}],"startTime":1772053094173,"endTime":1772053095572.3713,"status":"failed","message":"\nInvalid `prisma.otpVerification.deleteMany()` invocation in\nC:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/helpers/db.ts:15:34\n\n  12 await prisma.message.deleteMany({});\n  13 await prisma.conversation.deleteMany({});\n  14 await prisma.analyticsEvent.deleteMany({});\nΓåÆ 15 await prisma.otpVerification.deleteMany(\nThe table `public.otp_verifications` does not exist in the current database.","name":"C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/auth.test.ts"},{"assertionResults":[{"ancestorTitles":["GET /api/user/profile"],"fullName":"GET /api/user/profile should return 401 without session","status":"passed","title":"should return 401 without session","duration":21.351999999999975,"failureMessages":[],"meta":{}},{"ancestorTitles":["GET /api/user/profile"],"fullName":"GET /api/user/profile should return 401 with session but no linked user","status":"passed","title":"should return 401 with session but no linked user","duration":473.48789999999985,"failureMessages":[],"meta":{}},{"ancestorTitles":["GET /api/user/profile"],"fullName":"GET /api/user/profile should return profile for authenticated user","status":"failed","title":"should return profile for authenticated user","duration":92.84269999999992,"failureMessages":["PrismaClientKnownRequestError: \nInvalid `prisma.user.create()` invocation in\nC:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/helpers/setup.ts:48:24\n\n  45     name?: string;\n  46 }) {\n  47     const unique = randomBytes(4).toString(\"hex\");\nΓåÆ 48     return prisma.user.create(\nThe column `role` does not exist in the current database.\n    at ei.handleRequestError (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:121:7268)\n    at ei.handleAndLogRequestError (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:121:6593)\n    at ei.request (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:121:6300)\n    at a (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:130:9551)\n    at createAuthenticatedUser (C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/helpers/setup.ts:66:18)\n    at C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/user.test.ts:30:35\n    at file:///C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/node_modules/@vitest/runner/dist/index.js:915:20"],"meta":{}},{"ancestorTitles":["PATCH /api/user/profile"],"fullName":"PATCH /api/user/profile should update whitelisted fields","status":"failed","title":"should update whitelisted fields","duration":125.99969999999985,"failureMessages":["PrismaClientKnownRequestError: \nInvalid `prisma.user.create()` invocation in\nC:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/helpers/setup.ts:48:24\n\n  45     name?: string;\n  46 }) {\n  47     const unique = randomBytes(4).toString(\"hex\");\nΓåÆ 48     return prisma.user.create(\nThe column `role` does not exist in the current database.\n    at ei.handleRequestError (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:121:7268)\n    at ei.handleAndLogRequestError (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:121:6593)\n    at ei.request (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:121:6300)\n    at a (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:130:9551)\n    at createAuthenticatedUser (C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/helpers/setup.ts:66:18)\n    at C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/user.test.ts:45:29\n    at file:///C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/node_modules/@vitest/runner/dist/index.js:915:20"],"meta":{}},{"ancestorTitles":["PATCH /api/user/profile"],"fullName":"PATCH /api/user/profile should strip role from update payload (mass assignment protection)","status":"failed","title":"should strip role from update payload (mass assignment protection)","duration":104.4239,"failureMessages":["PrismaClientKnownRequestError: \nInvalid `prisma.user.create()` invocation in\nC:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/helpers/setup.ts:48:24\n\n  45     name?: string;\n  46 }) {\n  47     const unique = randomBytes(4).toString(\"hex\");\nΓåÆ 48     return prisma.user.create(\nThe column `role` does not exist in the current database.\n    at ei.handleRequestError (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:121:7268)\n    at ei.handleAndLogRequestError (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:121:6593)\n    at ei.request (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:121:6300)\n    at a (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:130:9551)\n    at createAuthenticatedUser (C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/helpers/setup.ts:66:18)\n    at C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/user.test.ts:59:35\n    at file:///C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/node_modules/@vitest/runner/dist/index.js:915:20"],"meta":{}},{"ancestorTitles":["PATCH /api/user/profile"],"fullName":"PATCH /api/user/profile should strip id from update payload","status":"failed","title":"should strip id from update payload","duration":154.76589999999987,"failureMessages":["PrismaClientKnownRequestError: \nInvalid `prisma.user.create()` invocation in\nC:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/helpers/setup.ts:48:24\n\n  45     name?: string;\n  46 }) {\n  47     const unique = randomBytes(4).toString(\"hex\");\nΓåÆ 48     return prisma.user.create(\nThe column `role` does not exist in the current database.\n    at ei.handleRequestError (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:121:7268)\n    at ei.handleAndLogRequestError (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:121:6593)\n    at ei.request (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:121:6300)\n    at a (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:130:9551)\n    at createAuthenticatedUser (C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/helpers/setup.ts:66:18)\n    at C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/user.test.ts:73:35\n    at file:///C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/node_modules/@vitest/runner/dist/index.js:915:20"],"meta":{}},{"ancestorTitles":["PATCH /api/user/profile"],"fullName":"PATCH /api/user/profile should return 401 without session","status":"passed","title":"should return 401 without session","duration":9.550799999999981,"failureMessages":[],"meta":{}},{"ancestorTitles":["GET /api/user/preferences"],"fullName":"GET /api/user/preferences should return preferences for authenticated user","status":"failed","title":"should return preferences for authenticated user","duration":145.40020000000004,"failureMessages":["PrismaClientKnownRequestError: \nInvalid `prisma.user.create()` invocation in\nC:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/helpers/setup.ts:48:24\n\n  45     name?: string;\n  46 }) {\n  47     const unique = randomBytes(4).toString(\"hex\");\nΓåÆ 48     return prisma.user.create(\nThe column `role` does not exist in the current database.\n    at ei.handleRequestError (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:121:7268)\n    at ei.handleAndLogRequestError (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:121:6593)\n    at ei.request (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:121:6300)\n    at a (C:\\Users\\grimm\\Projects\\Ideas_and_Pipelines\\jansathi-ai\\backend\\node_modules\\@prisma\\client\\runtime\\library.js:130:9551)\n    at createAuthenticatedUser (C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/helpers/setup.ts:66:18)\n    at C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/user.test.ts:95:29\n    at file:///C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/node_modules/@vitest/runner/dist/index.js:915:20"],"meta":{}}],"startTime":1772053094173,"endTime":1772053095301.4001,"status":"failed","message":"\nInvalid `prisma.otpVerification.deleteMany()` invocation in\nC:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/helpers/db.ts:15:34\n\n  12 await prisma.message.deleteMany({});\n  13 await prisma.conversation.deleteMany({});\n  14 await prisma.analyticsEvent.deleteMany({});\nΓåÆ 15 await prisma.otpVerification.deleteMany(\nThe table `public.otp_verifications` does not exist in the current database.","name":"C:/Users/grimm/Projects/Ideas_and_Pipelines/jansathi-ai/backend/tests/user.test.ts"}]}
